# 密码安全说明

## ⚠️ 重要安全提示

### 1. 测试连接时的密码传输

**当前行为**：
- 测试数据库连接时，密码会通过HTTP请求发送到后端
- 在浏览器开发者工具的Network面板中可以看到明文密码
- 这是测试连接的必要行为（需要真实密码来验证连接）

**安全措施**：
- ✅ 后端日志中**不会记录密码**
- ✅ 密码在数据库中**加密存储**
- ✅ 前端表单中密码字段**遮掩显示**

### 2. 必须使用HTTPS

**⚠️ 强烈建议**：
- **生产环境必须使用HTTPS协议**
- HTTPS会在传输层加密，即使开发者工具中看到请求，密码也是加密传输的
- 如果使用HTTP，密码会在网络中明文传输，存在严重安全风险

### 3. 安全建议

#### 开发环境
- 使用HTTPS（推荐）或仅在本地网络使用HTTP
- 不要在公共网络或不安全的WiFi上测试连接
- 测试完成后及时关闭开发者工具

#### 生产环境
- **必须配置HTTPS**
- 使用有效的SSL证书
- 配置安全响应头
- 定期更新依赖包以修复安全漏洞

## 🔒 已实施的安全措施

### 后端
1. **密码加密存储**：使用Fernet对称加密
2. **日志安全**：测试连接时不在日志中记录密码
3. **API响应**：返回配置列表时密码字段显示为`******`

### 前端
1. **密码遮掩**：输入框使用`type="password"`和`show-password`
2. **编辑时清空**：编辑配置时密码字段自动清空，需要重新输入

## 📋 安全检查清单

- [ ] 生产环境已配置HTTPS
- [ ] SSL证书有效且未过期
- [ ] 密码加密密钥安全存储（不在代码中硬编码）
- [ ] 定期更新依赖包
- [ ] 配置安全响应头（CSP、HSTS等）
- [ ] 限制管理员访问权限
- [ ] 启用审计日志

## 🛠️ 如何配置HTTPS

### 使用Nginx反向代理（推荐）

```nginx
server {
    listen 443 ssl http2;
    server_name your-domain.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    location / {
        proxy_pass http://localhost:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

### 使用Let's Encrypt免费证书

```bash
# 安装certbot
sudo apt-get install certbot python3-certbot-nginx

# 获取证书
sudo certbot --nginx -d your-domain.com
```

## 📝 注意事项

1. **开发者工具**：
   - 浏览器开发者工具可以看到所有网络请求
   - 这是浏览器的正常功能，无法完全避免
   - 使用HTTPS可以确保传输层加密

2. **密码管理**：
   - 建议使用强密码
   - 定期更换数据库密码
   - 不要在多个系统间共享密码

3. **访问控制**：
   - 限制可以访问配置页面的用户
   - 使用角色权限控制
   - 记录所有配置变更操作

## 🔍 如何验证HTTPS配置

1. 检查浏览器地址栏是否显示🔒锁图标
2. 检查URL是否以`https://`开头
3. 使用在线工具检查SSL配置：https://www.ssllabs.com/ssltest/

## ⚠️ 如果必须使用HTTP

如果暂时无法使用HTTPS（仅限开发环境），请注意：

1. **仅在本地网络使用**
2. **不要在生产环境使用HTTP**
3. **不要在公共网络或不安全的WiFi上使用**
4. **定期检查网络流量**
5. **尽快迁移到HTTPS**

## 📞 报告安全问题

如果发现安全问题，请立即：
1. 停止使用相关功能
2. 联系系统管理员
3. 记录问题详情
4. 等待修复后再使用

