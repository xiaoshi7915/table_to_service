# 用户使用手册

## 目录

1. [快速开始](#快速开始)
2. [数据源配置](#数据源配置)
3. [创建接口](#创建接口)
4. [智能问数](#智能问数)
5. [仪表板](#仪表板)
6. [常见问题](#常见问题)

---

## 快速开始

### 登录系统

1. 访问系统地址：http://121.36.205.70:3003
2. 使用管理员提供的账号登录
3. 首次登录后请立即修改密码

### 系统概览

系统主要功能模块：
- **数据表转接口**：将数据库表快速转换为RESTful API接口
- **智能问数**：使用自然语言查询数据，自动生成SQL和图表

---

## 数据源配置

### 添加数据源

1. 进入"数据源配置"页面
2. 点击"添加数据源"按钮
3. 填写数据库连接信息：
   - **数据库类型**：选择MySQL、PostgreSQL、SQLite、SQL Server或Oracle
   - **主机地址**：数据库服务器IP或域名
   - **端口**：数据库端口（系统会根据数据库类型自动填充默认端口）
   - **数据库名**：要连接的数据库名称
   - **用户名**：数据库用户名
   - **密码**：数据库密码（加密存储）
   - **描述**：可选，用于标识数据源的用途
4. 点击"测试连接"验证配置是否正确
5. 点击"保存"完成配置

### 管理数据源

- **编辑**：点击数据源列表中的"编辑"按钮修改配置
- **删除**：点击"删除"按钮删除不需要的数据源（注意：删除后相关接口将无法使用）
- **测试连接**：随时可以测试数据源连接状态

---

## 创建接口

系统支持三种方式创建接口：

### 1. 专家模式

适合熟悉SQL语法的开发者使用。

**步骤：**
1. 进入"数据表转接口"页面
2. 选择"专家模式"
3. 点击"下一步"
4. 配置SQL：
   - 选择数据源
   - 编写SQL语句（支持参数化查询，使用`:param_name`格式）
   - 示例：`SELECT * FROM users WHERE id = :id AND status = :status`
5. 点击"解析SQL"自动提取参数信息
6. 继续配置基础信息、代理接口、风险管控等
7. 确认配置并保存

**特点：**
- 直接编写SQL语句，灵活度高
- 支持复杂查询和高级SQL特性
- 自动解析SQL中的参数信息

### 2. 图形模式

通过可视化界面配置SQL，无需编写代码。

**步骤：**
1. 进入"数据表转接口"页面
2. 选择"图形模式"
3. 点击"下一步"
4. 配置SQL：
   - 选择数据源
   - 选择数据表
   - 选择要查询的字段（可多选）
   - 配置WHERE条件（可选）
   - 配置排序规则（可选）
5. 实时预览生成的SQL语句
6. 继续配置基础信息、代理接口、风险管控等
7. 确认配置并保存

**特点：**
- 无需SQL知识，通过点选即可完成配置
- 适合非技术人员使用
- 实时预览生成的SQL语句

### 3. 问数模式

通过智能问数生成SQL，自动创建接口配置。

**步骤：**
1. 进入"数据表转接口"页面
2. 选择"问数模式"
3. 点击"下一步"跳转到智能问数页面
4. 在智能问数页面：
   - 选择数据源
   - 用自然语言提问，例如："查询各区域的销售量总和"
   - 系统自动生成SQL并执行查询
   - 查看查询结果和图表
5. 在查询结果中点击"导出" → "生成服务接口"
6. 输入接口路径（系统会自动添加`/api/query`前缀）
7. 系统自动创建接口配置

**特点：**
- 使用自然语言提问，AI自动生成SQL
- 从问数结果一键生成服务接口
- 自动解析SQL参数和响应格式

### 接口配置说明

#### 基础信息
- **接口名称**：接口的唯一标识名称
- **接口描述**：接口的功能说明
- **使用说明**：接口的使用方法和注意事项
- **分类**：接口分类（可选）
- **状态**：激活/草稿/禁用

#### 代理接口
- **HTTP方法**：GET、POST、PUT、DELETE等
- **代理路径**：接口的URL路径（例如：`/api/users`）
- **请求格式**：application/json、application/xml等
- **响应格式**：application/json、application/xml等

#### 风险管控
- **分页设置**：是否启用分页，默认每页10条
- **最大查询数量**：单次查询最大返回行数（默认1000）
- **限流设置**：每分钟最大请求数
- **超时设置**：查询超时时间（秒）
- **IP白名单**：允许访问的IP地址列表
- **IP黑名单**：禁止访问的IP地址列表
- **审计日志**：是否记录操作日志

---

## 智能问数

### 开始对话

1. 进入"智能问数"页面
2. 选择数据源
3. 在输入框中输入问题，例如：
   - "查询各区域的销售量总和"
   - "显示最近一个月的销售趋势"
   - "哪个产品的销量最高？"
4. 按Enter或点击"发送"按钮
5. 系统自动生成SQL并执行查询
6. 查看查询结果和图表

### 图表操作

- **切换图表类型**：点击图表类型下拉菜单，选择柱状图、折线图、饼图、散点图、面积图或表格
- **查看数据明细**：点击"查看明细"按钮查看原始数据
- **导出数据**：点击"导出"按钮，选择导出格式（Excel、CSV、JSON、XML）
- **导出图表**：点击"导出" → "PNG图片"导出图表为图片
- **添加到仪表板**：点击"添加到仪表板"将图表保存到仪表板

### 多轮对话

系统支持连续提问，自动记忆上下文：
1. 第一轮：问"查询各区域的销售量"
2. 第二轮：问"哪个区域最高？"（系统会自动理解是指销售量最高的区域）
3. 继续提问，系统会基于前面的对话上下文生成SQL

### 历史对话

- **查看历史**：进入"历史对话"页面查看所有对话记录
- **搜索对话**：使用搜索框按关键词搜索对话
- **重命名对话**：点击对话标题旁的编辑按钮重命名
- **删除对话**：点击删除按钮删除不需要的对话
- **继续对话**：点击对话记录继续之前的对话

### 推荐问题

系统提供"猜你想问"功能，根据以下信息推荐问题：
- SQL示例库中的示例问题
- 历史对话记录
- 当前数据源的表结构

点击推荐问题可以快速提问。

---

## 仪表板

### 创建仪表板

1. 进入"仪表板"页面
2. 点击"创建仪表板"按钮
3. 填写仪表板名称和描述
4. 点击"保存"

### 添加图表

有两种方式添加图表到仪表板：

**方式1：从智能问数添加**
1. 在智能问数页面生成图表
2. 点击"添加到仪表板"按钮
3. 选择目标仪表板
4. 输入组件标题
5. 点击"确认"

**方式2：在仪表板编辑页面添加**
1. 进入仪表板编辑页面
2. 点击"添加组件"按钮
3. 选择组件类型和配置
4. 调整组件位置和大小

### 查看仪表板

1. 进入"仪表板"页面
2. 点击仪表板名称进入查看页面
3. 查看所有图表和数据
4. 支持全屏展示

---

## 常见问题

### Q1: 如何修改接口配置？

A: 在"接口清单"页面找到要修改的接口，点击"编辑"按钮进行修改。

### Q2: 接口执行失败怎么办？

A: 检查以下几点：
1. 数据源连接是否正常
2. SQL语句是否正确
3. 参数是否正确传递
4. 查看错误信息提示

### Q3: 智能问数生成的SQL不正确怎么办？

A: 可以：
1. 点击SQL语句进行编辑
2. 修改后重新执行
3. 继续用自然语言提问，系统会基于上下文调整

### Q4: 如何导出数据？

A: 在智能问数结果页面：
1. 点击"导出"按钮
2. 选择导出格式（Excel、CSV、JSON、XML）
3. 文件会自动下载

### Q5: 如何查看接口文档？

A: 在"API文档"页面可以查看所有接口的详细文档，包括：
- 接口URL
- 请求参数
- 响应示例
- cURL示例

### Q6: 问数模式接口的默认分页参数是什么？

A: 默认分页参数：
- `pageSize=10`（每页10条）
- `pageNumber=1`（第一页）

可以在URL中指定，例如：`/api/query/my-query?pageSize=20&pageNumber=1`

---

## 技术支持

如遇到问题，请联系系统管理员或查看系统文档。
